---
const {
  title = '',
  oneLiner = '',
  keyResults = [],
  situation = '',
  intervention = [],
  playbook = [],
  role,
  timeframe,
  domain,
} = Astro.props as {
  title: string;
  oneLiner: string;
  keyResults: string[];
  situation: string;
  intervention: string[];
  playbook: string[];
  role?: string;
  timeframe?: string;
  domain?: string;
};
---

<article class="rounded-lg border border-neutral-200 bg-white/80 shadow-sm">
	<div class="px-4 py-4 md:px-6 md:py-6">
		<!-- ALWAYS VISIBLE: Title, One-liner, Key Results, Playbook -->
		<header class="space-y-2">
			<h3 class="text-lg md:text-xl font-semibold tracking-tight">{title}</h3>
			<p class="text-neutral-700">{oneLiner}</p>
			{(role || timeframe || domain) && (
				<div class="mt-2 flex flex-wrap gap-2 text-sm text-neutral-700">
					{role && (<span class="inline-flex items-center rounded-md border border-neutral-200 bg-neutral-50 px-2 py-0.5">{role}</span>)}
					{timeframe && (<span class="inline-flex items-center rounded-md border border-neutral-200 bg-neutral-50 px-2 py-0.5">{timeframe}</span>)}
					{domain && (<span class="inline-flex items-center rounded-md border border-neutral-200 bg-neutral-50 px-2 py-0.5">{domain}</span>)}
				</div>
			)}
		</header>

		{keyResults?.length > 0 && (
			<section class="mt-4">
				<h4 class="text-base md:text-lg font-medium">Key Results</h4>
				<ul class="mt-2 list-disc pl-5 space-y-2 text-neutral-800 leading-relaxed">
					{keyResults.map((item) => <li>{item}</li>)}
				</ul>
			</section>
		)}

		{playbook?.length > 0 && (
			<section class="mt-6">
				<h4 class="text-base md:text-lg font-semibold">My Repeatable Playbook</h4>
				<ol class="mt-2 list-decimal pl-5 space-y-2 text-neutral-900 leading-relaxed rounded-md border border-neutral-200 bg-neutral-50 p-3 md:p-4">
					{playbook.map((step) => <li>{step}</li>)}
				</ol>
			</section>
		)}

		<!-- COLLAPSIBLE: Situation + Intervention -->
		<details class="mt-6 group cs-disclosure">
			<summary class="w-full cursor-pointer inline-flex items-center rounded-md border border-neutral-300 bg-white px-3 py-1.5 text-sm md:text-base text-slate-900 hover:bg-neutral-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-neutral-300 select-none">
				<span class="group-open:inline hidden">Hide full story</span>
				<span class="group-open:hidden inline">Read full story</span>
			</summary>

			<div class="mt-6 space-y-6 text-neutral-800">
				<div>
					<h4 class="text-base md:text-lg font-medium">The Situation</h4>
					<p class="mt-2">{situation}</p>
				</div>
				<div>
					<h4 class="text-base md:text-lg font-medium">My Intervention</h4>
					{intervention?.length > 0 && (
						<ol class="mt-2 list-decimal pl-5 space-y-2 leading-relaxed">
							{intervention.map((step) => <li>{step}</li>)}
						</ol>
					)}
				</div>
			</div>
		</details>
	</div>
</article>

<style>
	/* Hide default marker only within this component */
	.cs-disclosure summary::-webkit-details-marker {
		display: none;
	}
</style>


